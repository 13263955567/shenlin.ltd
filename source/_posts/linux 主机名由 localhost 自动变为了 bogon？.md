# linux 主机名由 localhost 自动变为了 bogon？

标签（空格分隔）： AAA linux bogon

---

bogon['bɔɡən] n. 虚伪的人

主机名改变会导致一些儿错误，如数据库启动失败，username@localhost变成了username@bogon

linux 的主机名在未修改的情况下，自动从 localhost.localdomain 变为了 bogon，什么原因？

简单来说，是在 linux 启动的过程中，执行的一个脚本发现主机名是 localhost 或 localhost.localdomain 时会进行反向解析，即根据当前的 IP 地址去 DNS 服务器上获取对应的主机名，而有些儿 DNS 服务器会把保留地址、私有地址的主机名解析为bogon

```
//配置文件里仍然是localhost
ssy@bogon ~
>> vi /etc/sysconfig/network
NETWORKING=yes
HOSTNAME=localhost

//在rc.sysinit文件中进行了ip到域名的反向解析
//这段代码判断主机名如果是localhost或者localhost.localdomain，则获取主机IP地址并执行DNS逆向解析，将解析到的结果赋值给HOSTNAME。
ssy@bogon ~
>> vi /etc/rc.sysinit 
......
ipaddr=
if [ "$HOSTNAME" = "localhost" -o "$HOSTNAME" = "localhost.localdomain" ]; then
        ipaddr=$(ip addr show to 0.0.0.0/0 scope global | awk '/[[:space:]]inet / { print gensub("/.*","","g",$2) }')
        for ip in $ipaddr ; do
                HOSTNAME=
                eval $(ipcalc -h $ip 2>/dev/null)
                [ -n "$HOSTNAME" ] && { hostname ${HOSTNAME} ; break; }
        done
fi
......

//反向解析举例
ssy@bogon ~
>> ipcalc -h 127.0.0.1
HOSTNAME=localhost

ssy@bogon ~
>> ipcalc -h 10.61.3.1
HOSTNAME=bogon

ssy@bogon ~
>> ipcalc -h 114.241.251.125
ipcalc: cannot find hostname for 114.241.251.125: Unknown host

//dns解析服务器配置文件
ssy@bogon ~
>> vi /etc/resolv.conf
; generated by /sbin/dhclient-script
nameserver 172.30.204.111
nameserver 123.125.81.6
search bogon

//查看主机名
ssy@bogon ~
>> hostname
bogon

//更改主机名，临时
ssy@bogon ~
>> sudo hostname e42.matrix

//改完了提示符没有变
ssy@bogon ~
>> hostname
e42.matrix
```


解决方法：

推荐的最佳解决方案，是修改主机名，只要主机名不是localhost或者localhost.localdomain，那么操作系统就不会执行DNS反向解析等操作，问题自然也不会出现。具体操作就是修改/etc/sysconfig/network文件中HOSTNAME键值。

而且并不推荐使用默认主机名进行系统安装。

再有就是更改DNS域名服务器，有些域名服务器会对bogon进行过滤。
而有些DNS服务器，会将私有地址，保留地址这样的不应该出现在网络上的IP地址解析成bogon


